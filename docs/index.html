<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>「ユドナリウム」用 まかでみRPG キャラクターコマ 作成ページ</title>
    <style type="text/css">
html{color:#000;background:#FFF;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,var{font-style:normal;font-weight:normal;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:text-top;}sub{vertical-align:text-bottom;}input,textarea,select{font-family:inherit;font-size:inherit;font-weight:inherit;}input,textarea,select{*font-size:100%;}legend{color:#000;}del,ins{text-decoration:none;}body{font:13px/1.231 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small;}select,input,button,textarea{font:99% arial,helvetica,clean,sans-serif;}table{font-size:inherit;font:100%;}pre,code,kbd,samp,tt{font-family:monospace;*font-size:108%;line-height:100%;}body{text-align:center;}#ft{clear:both;}#doc,#doc2,#doc3,#doc4,.yui-t1,.yui-t2,.yui-t3,.yui-t4,.yui-t5,.yui-t6,.yui-t7{margin:auto;text-align:left;width:57.69em;*width:56.25em;min-width:750px;}#doc2{width:73.076em;*width:71.25em;}#doc3{margin:auto 10px;width:auto;}#doc4{width:74.923em;*width:73.05em;}.yui-b{position:relative;}.yui-b{_position:static;}#yui-main .yui-b{position:static;}#yui-main,.yui-g .yui-u .yui-g{width:100%;}{width:100%;}.yui-t1 #yui-main,.yui-t2 #yui-main,.yui-t3 #yui-main{float:right;margin-left:-25em;}.yui-t4 #yui-main,.yui-t5 #yui-main,.yui-t6 #yui-main{float:left;margin-right:-25em;}.yui-t1 .yui-b{float:left;width:12.30769em;*width:12.00em;}.yui-t1 #yui-main .yui-b{margin-left:13.30769em;*margin-left:13.05em;}.yui-t2 .yui-b{float:left;width:13.8461em;*width:13.50em;}.yui-t2 #yui-main .yui-b{margin-left:14.8461em;*margin-left:14.55em;}.yui-t3 .yui-b{float:left;width:23.0769em;*width:22.50em;}.yui-t3 #yui-main .yui-b{margin-left:24.0769em;*margin-left:23.62em;}.yui-t4 .yui-b{float:right;width:13.8456em;*width:13.50em;}.yui-t4 #yui-main .yui-b{margin-right:14.8456em;*margin-right:14.55em;}.yui-t5 .yui-b{float:right;width:18.4615em;*width:18.00em;}.yui-t5 #yui-main .yui-b{margin-right:19.4615em;*margin-right:19.125em;}.yui-t6 .yui-b{float:right;width:23.0769em;*width:22.50em;}.yui-t6 #yui-main .yui-b{margin-right:24.0769em;*margin-right:23.62em;}.yui-t7 #yui-main .yui-b{display:block;margin:0 0 1em 0;}#yui-main .yui-b{float:none;width:auto;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf,.yui-gc .yui-u,.yui-gd .yui-g,.yui-g .yui-gc .yui-u,.yui-ge .yui-u,.yui-ge .yui-g,.yui-gf .yui-g,.yui-gf .yui-u{float:right;}.yui-g div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first,.yui-ge div.first,.yui-gf div.first,.yui-g .yui-gc div.first,.yui-g .yui-ge div.first,.yui-gc div.first div.first{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf{width:49.1%;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{width:32%;margin-left:1.99%;}.yui-gb .yui-u{*margin-left:1.9%;*width:31.9%;}.yui-gc div.first,.yui-gd .yui-u{width:66%;}.yui-gd div.first{width:32%;}.yui-ge div.first,.yui-gf .yui-u{width:74.2%;}.yui-ge .yui-u,.yui-gf div.first{width:24%;}.yui-g .yui-gb div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first{margin-left:0;}.yui-g .yui-g .yui-u,.yui-gb .yui-g .yui-u,.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u,.yui-ge .yui-g .yui-u,.yui-gf .yui-g .yui-u{width:49%;*width:48.1%;*margin-left:0;}.yui-g .yui-g .yui-u{width:48.1%;}.yui-g .yui-gb div.first,.yui-gb .yui-gb div.first{*margin-right:0;*width:32%;_width:31.7%;}.yui-g .yui-gc div.first,.yui-gd .yui-g{width:66%;}.yui-gb .yui-g div.first{*margin-right:4%;_margin-right:1.3%;}.yui-gb .yui-gc div.first,.yui-gb .yui-gd div.first{*margin-right:0;}.yui-gb .yui-gb .yui-u,.yui-gb .yui-gc .yui-u{*margin-left:1.8%;_margin-left:4%;}.yui-g .yui-gb .yui-u{_margin-left:1.0%;}.yui-gb .yui-gd .yui-u{*width:66%;_width:61.2%;}.yui-gb .yui-gd div.first{*width:31%;_width:29.5%;}.yui-g .yui-gc .yui-u,.yui-gb .yui-gc .yui-u{width:32%;_float:right;margin-right:0;_margin-left:0;}.yui-gb .yui-gc div.first{width:66%;*float:left;*margin-left:0;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf .yui-u{margin:0;}.yui-gb .yui-gb .yui-u{_margin-left:.7%;}.yui-gb .yui-g div.first,.yui-gb .yui-gb div.first{*margin-left:0;}.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u{*width:48.1%;*margin-left:0;} .yui-gb .yui-gd div.first{width:32%;}.yui-g .yui-gd div.first{_width:29.9%;}.yui-ge .yui-g{width:24%;}.yui-gf .yui-g{width:74.2%;}.yui-gb .yui-ge div.yui-u,.yui-gb .yui-gf div.yui-u{float:right;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf div.first{float:left;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf div.first{*width:24%;_width:20%;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf .yui-u{*width:73.5%;_width:65.5%;}.yui-ge div.first .yui-gd .yui-u{width:65%;}.yui-ge div.first .yui-gd div.first{width:32%;}#bd:after,.yui-g:after,.yui-gb:after,.yui-gc:after,.yui-gd:after,.yui-ge:after,.yui-gf:after{content:".";display:block;height:0;clear:both;visibility:hidden;}#bd,.yui-g,.yui-gb,.yui-gc,.yui-gd,.yui-ge,.yui-gf{zoom:1;}</style>
    <style type="text/css">
h1{font-size:138.5%;}h2{font-size:123.1%;}h3{font-size:108%;}h1,h2,h3{margin:1em 0;}h1,h2,h3,h4,h5,h6,strong{font-weight:bold;}abbr,acronym{border-bottom:1px dotted #000;cursor:help;} em{font-style:italic;}blockquote,ul,ol,dl{margin:1em;}ol,ul,dl{margin-left:2em;}ol li{list-style:decimal outside;}ul li{list-style:disc outside;}dl dd{margin-left:1em;}th,td{border:1px solid #000;padding:.5em;}th{font-weight:bold;text-align:center;}caption{margin-bottom:.5em;text-align:center;}p,fieldset,table,pre{margin-bottom:1em;}input[type=text],input[type=password],textarea{width:12.25em;*width:11.9em;}
</style><meta name="author" content="Owner">
    <meta name="generator" content="BlueGriffon wysiwyg editor">
  </head>
  <body onload="PageLoad();">
    <div id="doc3" class="yui-t1">
      <div id="hd">
        <h1>「ユドナリウム」用 まかでみRPG キャラクターコマ 作成ページ</h1>
      </div>
      <div id="DropFrame" style="background-color:#b8deff;border:solid 1px #3470ff; width:360px; height:40px;">す
        でにzipがあれば，ここにドロップ</div>
      <div id="output"></div>
      <hr>
      <div>キャラクター名：<input name="base.name" type="text"></div>
      <div>プレイヤー名：<input name="base.player" type="text"></div>
      <div>種族：<input name="base.race" type="text"></div>
      <div>カバー：<input name="base.cover" type="text"></div>
      <div>
        <hr><strong>クラス</strong></div>
      <div><br>
      </div>
      <div>クラス：<input name="class.1" type="text"> (レベル：<input name="level.1" type="text">)</div>
      <div>クラス：<input name="class.2" type="text"> (レベル：<input name="level.2" type="text">)</div>
      <div>クラス：<input name="class.3" type="text"> (レベル：<input name="level.3" type="text">)</div>
      <div>
        <hr><strong>能力基本値</strong></div>
      <div><br>
      </div>
      <div>体力：<input name="ability.strong" onchange="OnInputAbility(this)" type="text">
        (ボーナス：<input name="ability_b.strong" value="0" disabled="disabled" type="text">)</div>
      <div>反射：<input name="ability.reflexes" onchange="OnInputAbility(this)" type="text">
        (ボーナス：<input name="ability_b.reflexes" value="0" disabled="disabled" type="text">)</div>
      <div>知覚：<input name="ability.sense" onchange="OnInputAbility(this)" type="text">
        (ボーナス：<input name="ability_b.sense" value="0" disabled="disabled" type="text">)</div>
      <div>理知：<input name="ability.intellect" onchange="OnInputAbility(this)" type="text">
        (ボーナス：<input name="ability_b.intellect" value="0" disabled="disabled" type="text">)</div>
      <div>意志：<input name="ability.will" onchange="OnInputAbility(this)" type="text">
        (ボーナス：<input name="ability_b.will" value="0" disabled="disabled" type="text">)</div>
      <div>幸運：<input name="ability.blessing" onchange="OnInputAbility(this)" type="text">
        (ボーナス：<input name="ability_b.blessing" value="0" disabled="disabled" type="text">)</div>
      <div>
        <hr><strong>戦闘値(現在値)</strong></div>
      <div><br>
      </div>
      <div>命中値：<input name="outfits.total.hit" type="text"></div>
      <div>回避値：<input name="outfits.total.dodge" type="text"></div>
      <div>魔導値：<input name="outfits.total.magic" type="text"></div>
      <div>抗魔値：<input name="outfits.total.countermagic" type="text"></div>
      <div>行動値：<input name="outfits.total.action" onchange="OnInputOutfitsAction(this)"

          type="text"></div>
      <div>耐久値：<input name="outfits.total.hp" type="text"></div>
      <div>精神値：<input name="outfits.total.mp" type="text"><br>
        <hr><strong>移動力</strong></div>
      <div><br>
      </div>
      <div>戦闘移動：<input name="move.combat" value="0" disabled="disabled" type="text">m</div>
      <div>全力移動：<input name="move.full" value="0" disabled="disabled" type="text">m</div>
      <hr><br>    
    

      <div> <button type="button" name="button_save" onclick="OnClickSaveButton(this)">zip
          に書き出し</button> </div>

    <br>
    <script type="text/javascript" src="https://js.cybozu.com/jszip/v3.1.5/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js"></script>
    <script type="text/javascript">

      function getByName(name) {
        return document.getElementsByName(name).item(0).value; 
      }

      function getElemByName(name) {
        return document.getElementsByName(name).item(0); 
      }

      // 能力値の入力時に能力値ボーナスを計算する
      function OnInputAbility($this) {
        getElemByName("ability_b.strong").value = Math.floor(getByName("ability.strong") / 4);
        getElemByName("ability_b.reflexes").value = Math.floor(getByName("ability.reflexes") / 4);
        getElemByName("ability_b.sense").value = Math.floor(getByName("ability.sense") / 4);
        getElemByName("ability_b.intellect").value = Math.floor(getByName("ability.intellect") / 4);
        getElemByName("ability_b.will").value = Math.floor(getByName("ability.will") / 4);
        getElemByName("ability_b.blessing").value = Math.floor(getByName("ability.blessing") / 4);
      }

      // 行動値の入力時に移動力を計算する
      function OnInputOutfitsAction($this) {
        getElemByName("move.combat").value = Number(getByName("outfits.total.action")) + 5;
        getElemByName("move.full").value = getByName("move.combat") * 2;
      }

      /* xml の elem 作成 */
      function createElem(name, text) {
          var elem = document.createElement('data');
          elem.setAttribute('name', name);
          elem.innerText = text;
          return elem;
      }

      /* numberResource である xml elem 作成 */
      function createNumRcElem(name, maxValue, currentValue) {
          var elem = document.createElement('data');
          elem.setAttribute('name', name);
          elem.innerText = maxValue;
          elem.setAttribute('type', 'numberResource');
          elem.setAttribute('currentValue', currentValue);
          return elem;
      }

      /* source から指定された name を取得し，xml elem を作成 */
      function createElemByName(html_name, xml_name) {
          return createElem(xml_name, getByName(html_name));
      }

      /******** 各ブロックの作成処理 ********/

      function createImgBlock() {
        var img = document.createElement('data');
        img.setAttribute('name', 'image');
        var elem = document.createElement('data');
        elem.setAttribute('type', 'image');
        elem.setAttribute('name', 'imageIdentifier');
        elem.innerText = 'null';
        img.appendChild(elem);

        return img;
      }

      function createCommonBlock() {
        var common = document.createElement('data');
        common.setAttribute('name', 'common');      
        common.appendChild(createElemByName('base.name', 'name' ));
        common.appendChild(createElemByName('base.player', 'プレイヤー名' ));

        common.appendChild(createElemByName('base.race', '種族' ));
        common.appendChild(createElemByName('base.cover', 'カバー' ));

        common.appendChild(createElemByName('class.1', 'クラス1' ));
        common.appendChild(createElemByName('level.1', 'クラス1のレベル' ));
        common.appendChild(createElemByName('class.2', 'クラス2' ));
        common.appendChild(createElemByName('level.2', 'クラス2のレベル' ));
        common.appendChild(createElemByName('class.3', 'クラス3' ));
        common.appendChild(createElemByName('level.3', 'クラス3のレベル' ));
        
        common.appendChild(createNumRcElem('衝動点', 10, 0));

        return common;
      }

      function createResourceBlock() {
        /* キャラシートからHP, MPを取得 */
        var hp = getByName('outfits.total.hp');
        var mp = getByName('outfits.total.mp');

        var resource = document.createElement('data');
        resource.setAttribute('name', 'リソース');
        resource.appendChild(createNumRcElem('HP', hp, hp));
        resource.appendChild(createNumRcElem('MP', mp, mp));

        return resource;
      }

      function createMoveBlock() {
        var move = document.createElement('data');
        move.setAttribute('name', '行動・移動');
        move.appendChild(createElemByName('outfits.total.action', '行動値'));
        move.appendChild(createElemByName('move.combat', '戦闘移動'));
        move.appendChild(createElemByName('move.full', '全力移動'));

        return move;
      }

      function createAbilityBonusBlock() {
        var ability_b = document.createElement('data');
        ability_b.setAttribute('name', '能力値ボーナス');
        ability_b.appendChild(createElemByName('ability_b.strong', '体力'));
        ability_b.appendChild(createElemByName('ability_b.reflexes','反射'));
        ability_b.appendChild(createElemByName('ability_b.sense', '知覚'));
        ability_b.appendChild(createElemByName('ability_b.intellect', '理知'));
        ability_b.appendChild(createElemByName('ability_b.will', '意志'));
        ability_b.appendChild(createElemByName('ability_b.blessing', '幸運'));

        return ability_b;
      }

      function createAbilityBlock() {
        var ability = document.createElement('data');
        ability.setAttribute('name', '能力基本値');
        ability.appendChild(createElemByName('ability.strong', '体力基本値'));
        ability.appendChild(createElemByName('ability.reflexes','反射基本値'));
        ability.appendChild(createElemByName('ability.sense', '知覚基本値'));
        ability.appendChild(createElemByName('ability.intellect', '理知基本値'));
        ability.appendChild(createElemByName('ability.will', '意志基本値'));
        ability.appendChild(createElemByName('ability.blessing', '幸運基本値'));

        return ability;
      }

      function createOutfitsBlock() {
        var outfits = document.createElement('data');
        outfits.setAttribute('name', '戦闘値');
        outfits.appendChild(createElemByName('outfits.total.hit', '命中'));
        outfits.appendChild(createElemByName('outfits.total.dodge', '回避'));
        outfits.appendChild(createElemByName('outfits.total.magic', '魔導'));
        outfits.appendChild(createElemByName('outfits.total.countermagic', '抗魔'));
        outfits.appendChild(createElemByName('outfits.total.action', '行動'));
        outfits.appendChild(createElemByName('outfits.total.hp', '耐久'));
        outfits.appendChild(createElemByName('outfits.total.mp', '精神'));

        return outfits;
      }

      function createChatPaletteBlock() {
        var cpd = document.createElement('chat-palette');

        var txt = '';
        txt += '========= 基本的な判定 ======== \n';
        txt += '2d6+{体力} 【体力】\n';
        txt += '2d6+{反射} 【反射】\n';
        txt += '2d6+{知覚} 【知覚】\n';
        txt += '2d6+{理知} 【理知】\n';
        txt += '2d6+{意志} 【意志】\n';
        txt += '2d6+{幸運} 【幸運】\n';
        txt += '\n';
        txt += '========= 戦闘中の判定 ======== \n';
        txt += '2d6+{命中} 【命中】\n';
        txt += '2d6+{回避} 【回避】\n';
        txt += '2d6+{魔導} 【魔導】\n';
        txt += '2d6+{抗魔} 【抗魔】\n';
        cpd.innerText = txt;

        return cpd;
      }

      // zip をセーブする
      function OnClickSaveButton($this) {

        /* xml を生成 */
        var xml = document.createElement('character');
        xml.setAttribute('location.x', '0');
        xml.setAttribute('location.y', '0');
        xml.setAttribute('posZ', '0');

        /* xml の root に char 要素を作成する */
        var char = document.createElement('data');
        char.setAttribute('name', 'character');

        /* img ブロックを作成し，char の子ノードとする */
        char.appendChild(createImgBlock());

        /* common (キャラクター名，プレイヤー名など) ブロックを作成し，char の子ノードとする */
        char.appendChild(createCommonBlock());

        /* detail (能力値など) ブロックを作成し，char の子ノードとする */
        var detail = document.createElement('data');
        detail.setAttribute('name', 'detail');
        char.appendChild(detail);

        /* resource (HP, MP)ブロックを作成し，detail の子ノードとする */
        detail.appendChild(createResourceBlock());

        /* move (行動値，移動値)ブロックを作成し，detail の子ノードとする */
        detail.appendChild(createMoveBlock());
  
        /* ability_b (能力値ボーナス)ブロックを作成し，detail の子ノードとする */
        detail.appendChild(createAbilityBonusBlock());

        /* ability (能力値ボーナス)ブロックを作成し，detail の子ノードとする */
        detail.appendChild(createAbilityBlock());

        /* outfits (戦闘値) ブロックを作成し，detail の子ノードとする */
        detail.appendChild(createOutfitsBlock());

        /* 雛形にキャラデータとチャットパレットを設定 */
        xml.appendChild(char);
        xml.appendChild(createChatPaletteBlock());

        /* xml を zip 圧縮 */
        var s = new XMLSerializer();
        var out = s.serializeToString(xml);
        out = out.replace(/xmlns=.http:\/\/www\.w3\.org\/1999\/xhtml../, '');
        out = out.replace(/<br \/>/g, '\n');
        out = out.replace(/currentvalue/g, 'currentValue');
        var zip = new JSZip();
        var char_name = getByName('base.name');
        zip.file(`${char_name}.xml`, out);

        /* ファイル保存 */
        zip.generateAsync({type:'blob'})
        .then(function(blob) {
            saveAs(blob, `${char_name}.zip`);
        });
      }

      function setData(doc, html_name, xml_name) {
        getElemByName(html_name).value = doc.getElementsByName(xml_name)[0].innerHTML;    
      }

      function parseXml(xml) {
        var parser = new DOMParser();
        const doc = parser.parseFromString(xml, "text/xml");
        //text = doc.getElementsByName("体力")[0];
        //alert(text.innerHTML);

        //getElemByName("base.name").value = doc.getElementsByName("name")[0].innerHTML;    
        setData(doc, "base.name", "name");
        setData(doc, "base.player", "プレイヤー名");
        setData(doc, "base.race", "種族");
        setData(doc, "base.cover", "カバー");

        setData(doc, "class.1", "クラス1");
        setData(doc, "level.1", "クラス1のレベル");
        setData(doc, "class.2", "クラス2");
        setData(doc, "level.2", "クラス2のレベル");
        setData(doc, "class.3", "クラス3");
        setData(doc, "level.3", "クラス3のレベル");

        setData(doc, "ability_b.strong", "体力");
        setData(doc, "ability_b.reflexes", "反射");
        setData(doc, "ability_b.sense", "知覚");
        setData(doc, "ability_b.intellect", "理知");
        setData(doc, "ability_b.will", "意志");
        setData(doc, "ability_b.blessing", "幸運");

        setData(doc, "ability.strong", "体力基本値");
        setData(doc, "ability.reflexes", "反射基本値");
        setData(doc, "ability.sense", "知覚基本値");
        setData(doc, "ability.intellect", "理知基本値");
        setData(doc, "ability.will", "意志基本値");
        setData(doc, "ability.blessing", "幸運基本値");

        setData(doc, "outfits.total.hit", "命中");
        setData(doc, "outfits.total.dodge", "回避");
        setData(doc, "outfits.total.magic", "魔導");
        setData(doc, "outfits.total.countermagic", "抗魔");
        setData(doc, "outfits.total.action", "行動");
        setData(doc, "outfits.total.hp", "耐久");
        setData(doc, "outfits.total.mp", "精神");

        setData(doc, "move.combat", "戦闘移動");
        setData(doc, "move.full", "全力移動");

      }

    function onLoadZip(f) {
        var jszip = new JSZip();
        jszip.loadAsync(f)                               
        .then(function(zip) {
            zip.forEach(function (relativePath, zipEntry) {                  
                zip.file(zipEntry.name).async("string")
                    .then(function(data) {
                            parseXml(data);
                       });   
            });
        });
    }

    function handleFileSelect(evt) {
      evt.stopPropagation();
      evt.preventDefault();

      var files = evt.dataTransfer.files; 

      var output = [];
      for (var i = 0; i < files.length; i++) {
        //document.getElementById('output').innerHTML += files[i].name + '(' + files[i].size + ') '
        //  + files[i].lastModifiedDate.toLocaleDateString() + files[i].lastModifiedDate.toLocaleTimeString() +  ' - ' + files[i].type + '<br/>';
      
        onLoadZip(files[i]);
      }
    }

    function handleDragOver(evt) {
      evt.stopPropagation();
      evt.preventDefault();
      evt.dataTransfer.dropEffect = 'copy';
    }
    
    function PageLoad(evt) {
      var dropFrame = document.getElementById('DropFrame');
      dropFrame.addEventListener('dragover', handleDragOver, false);
      dropFrame.addEventListener('drop', handleFileSelect, false);
    }

    </script>
  </body>
</html>
